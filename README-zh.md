
# DeferSwap 白皮书 - V1.0

## 1 背景

截止到目前，几乎所有的 DEX 都是 AMM 的模式，市场缺少订单簿交易模式。中心化交易所都是订单簿交易，说明订单簿交易的需求是普遍存在的。

### 1.1 AMM 无偿损失

无偿损失简单的解释就是：当我们把一对 token 存入基于 AMM 的 DEX 之后，如果一种 token 以另一种 token 进行计价的价格上升，那么在价格上升后你把它们取出，得到的总价格比直接手握这两种 token 要低一些，低的这一部分就是损失，价格偏离越大损失就越大，所以可能造成亏损，特别是当两种 token 在实际中都要以其他稳定币来计价时。 AMM 自带无偿损失是无法避免的。

### 1.2 AMM 滑点的影响

AMM 是通过流动性池实现交易的，一个订单所占池子的百分比越大，滑点越高。

### 1.3 AMM 交易不会百分百成功

长时间的交易确认很有可能在市场波动的情况下导致最终交易确认时的价格超过了预先设置的承受范围而导致交易失败。特别是在网络拥堵的情况下，交易失败率会更高。

### 1.4 AMM 资金利用率较低

AMM 目前的主要问题之一是对 LP 提供的流动性的分配方式。举个例子，UniswapV2 在整个价格区间内统一分配资金，这意味着只有在市场价格附近分配的资金才能真正得到有效利用，而其余资金则被闲置了。这就导致了高滑点以及资本效率低下。

## 2 DeferSwap

DeferSwap 是基于订单簿的交易协议。用户可通过 DeferSwap 创建限价单然后等待成交。如果用户买价高于对手价则会自动吃单，如果用户的卖价低于对手价则也会自动吃单。
 
### 2.1 交易流程

用户创建限价单 -> 系统撮合交易(如果价格与对手价相符则会自动成交) -> 订单完成 

### 2.2 撮合交易

DeferSwap 支持撮合交易。不过订单撮合的逻辑并不是写在合约中而是在用户界面程序中，当用户创建限价单的时候，用户界面程序会根据价格自动匹配可以成交的订单，然后将数据与限价单一起提交 DeferSwap 合约处理，在参数正确的情况下，DeferSwap 合约将会自动完成吃单操作。

### 2.3 部分成交

考虑到并不是每个用户都可以完全吃下价格合适的限价单，因此，DeferSwap 支持部分成交。也就是说用户可以成交限价单的一部分，比如说三分之一，二分之一等等。

### 2.4 批量吃单

DeferSwap 支持批量吃单操作。也就说，如果您对于数个限价单的价格都满意想要全部吃下的话，DeferSwap 也是支持的。批量吃单的操作是可以节省操作时间，提高效率，促进成单。

## 3 代币

+ 代币符号：`DEFER`
+ 总量：`1,000,000,000`

### 3.1 DEFER 分配

+ 50% 用于交易挖矿[500,000,000]
+ 35% 分配给投资者[350,000,000]
+ 15% 分配给团队成员，分四年线性释放[150,000,000]

### 3.2 DEFER 代币权利

+ 决定社区金库的使用
+ 交易对上线
+ 交易费率设定
+ 交易费使用
+ LP奖励
+ 其它参数治理

### 3.3 治理要求

+ 创建提案至少需要 DEFER 供应量的 1%
+ DEFER 供应量的 4％ 需要投票赞成才能达到规定人数要求
+ 7天投票期
+ 执行2天时间的锁定延迟

## 4 交易挖矿

为促进平台交易，培养用户的交易习惯，DeferSwap 决定将 DEFER 总量的 50% 用于交易挖矿奖励。

### 4.1 规则

在 DeferSwap 成功成交的用户均可以参与 DeferSwap 的交易挖矿活动。交易挖矿奖励规则如下：

| 参数 | 符号 |
| --- | --- |
| `r` | 用户获得的实际奖励 |
| `R` | 奖励池 DEFER 总数 |
| `f` | 用户交易总额 |
| `d` | 用户 DEFER 质押总额 |
| `α` | 交易总额权重常数，默认：0.5 |
| `k` | 参与交易挖矿的人数 |
| `s` | 用户交易得分 |
| ![](https://latex.codecogs.com/gif.image?\sum_{n}s_{n}) | 所有用户交易得分总和 |
  
  
首先，计算用户的分数：  
  
![](https://latex.codecogs.com/gif.image?s=f^{\alpha}\times%20d^{(1-\alpha)})

  
根据分数计算出获得的奖励：  
  
![](https://latex.codecogs.com/gif.image?r=R\times\frac{s}{\sum_{n}s_{n}},n=1,2...k)
  
  
### 4.2 奖励池

在 DeferSwap 协议启动之后，指定某个区块为开始区块，之后每个区块释放 20 枚 DEFER 到奖励池中，直到 500,000,000 DEFER 全部释放完毕。

### 4.3 DEFER 抵押

抵押的 `DEFER` 越多获得的奖励越多。抵押的 `DEFER` 有 30 天的提现限制。

## 5 交易费用

交易费用暂定为：0.5%

### 5.1 使用用途

初始使用用途如下：

+ 100% 的交易费用用于回购 DEFER 并销毁

> DeferSwap 社区可投票重新定义用途。

